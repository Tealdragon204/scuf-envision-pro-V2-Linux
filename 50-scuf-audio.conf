# SCUF Envision Pro V2 â€” Fix broken USB audio volume control
#
# The SCUF's "Headset" ALSA mixer element reports an invalid dB range
# (-42 to -16 dB, never reaches 0 dB). WirePlumber disables dB-based
# volume mapping, making hardware volume non-functional.
#
# Fix: Force PipeWire to use software volume mixing and ignore the
# broken hardware dB scale. The udev rules set the hardware mixer to
# max on connect so software attenuation has the full signal range.
#
# Match on api.alsa.card.name (the property actually present on the
# ALSA sink node), NOT device.vendor.id/device.product.id (which don't
# exist on these nodes).
#
# Install: sudo cp 50-scuf-audio.conf /etc/wireplumber/wireplumber.conf.d/
# Then restart WirePlumber or reboot.

monitor.alsa.rules = [
  {
    matches = [
      {
        api.alsa.card.name = "SCUF Envision Pro Controller V2"
      }
    ]
    actions = {
      update-props = {
        api.alsa.soft-mixer = true
        api.alsa.ignore-dB = true
      }
    }
  }
  {
    matches = [
      {
        api.alsa.card.name = "SCUF Envision Pro Wireless USB"
      }
    ]
    actions = {
      update-props = {
        api.alsa.soft-mixer = true
        api.alsa.ignore-dB = true
      }
    }
  }
]
